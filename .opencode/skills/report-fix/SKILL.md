---
name: report-fix
description: Generate a structured report of an Astro bug fix. Use after the fix skill has run. Reads fix.json and diagnosis.json to produce a markdown report suitable for posting as a GitHub issue comment or PR description.
---

# Report Fix Skill

Generate a markdown report summarizing a successful bug fix.

## Prerequisites

- `fix.json` exists in the triage directory with `fixed: true`
- `diagnosis.json` exists with root cause analysis

## Overview

1. Read the fix and diagnosis results
2. Generate a comprehensive markdown report
3. Write to `report.md` in the triage directory

## Step 1: Read Results

Read from the triage directory:
- `fix.json` — the fix details and git diff
- `diagnosis.json` — the root cause analysis
- `reproduction.json` — the original reproduction details

## Step 2: Generate Report

Write a markdown report to `triage/<dir>/report.md` following this structure:

```markdown
## Automated Triage Report

**Status:** ✅ Reproduced and Fixed

I was able to reproduce this issue and develop a fix.

### Summary

**Cause:** [One sentence from diagnosis.rootCause]

**Fix:** [One sentence from fix.description]

---

<details>
<summary><strong>Reproduction Details</strong></summary>

### Environment
- **Astro:** [version]
- **Node.js:** [version]

### Steps to Reproduce
1. [Step 1]
2. [Step 2]

### Error Observed
```
[Error message]
```

</details>

<details>
<summary><strong>Root Cause Analysis</strong></summary>

[Full explanation from diagnosis.explanation]

**Affected files:**
- `[file1]`
- `[file2]`

</details>

<details>
<summary><strong>Proposed Fix</strong></summary>

[Fix description]

### Changes

```diff
[git diff from fix.gitDiff]
```

### Verification
[Steps to verify the fix]

</details>

---

### Next Steps

A maintainer should:
1. Review the proposed fix
2. Consider edge cases and potential regressions  
3. Create a PR if the approach is approved

---
*This report was generated by automated triage. Fixes require maintainer review before merging.*
```

## Formatting Guidelines

**Keep diffs readable:**
- If the diff is very long, summarize the key changes first
- Use syntax highlighting with ```diff

**Be precise about files:**
- Include full paths from repo root
- Include line numbers where relevant

**Explain the "why":**
- Don't just show what changed
- Explain why this change fixes the bug
- Note any tradeoffs or alternatives considered

## Step 3: Write Output

Write the report to `triage/<dir>/report.md`.

The report should help a maintainer:
- Quickly understand the bug and fix
- Make an informed decision about the approach
- Create a PR with minimal additional work
